// Translations for Lucky Draw Application
const translations = {
    vi: {
        // Header
        appTitle: 'QUAY LÃ€ TRÃšNG',
        
        // Prize levels
        prizeSpecial: 'GIáº¢I Äáº¶C BIá»†T',
        prizeFirst: 'GIáº¢I NHáº¤T',
        prizeSecond: 'GIáº¢I NHÃŒ',
        prizeThird: 'GIáº¢I BA',
        prizeConsolation: 'GIáº¢I KHUYáº¾N KHÃCH',
        
        // Display area
        instruction: 'Nháº¥n nÃºt Quay sá»‘ Ä‘á»ƒ báº¯t Ä‘áº§u',
        
        // Buttons
        btnDraw: 'QUAY Sá»',
        btnDrawing: 'ÄANG QUAY...',
        btnLoad: 'Táº£i danh sÃ¡ch',
        btnRegister: 'ÄÄ‚NG KÃ',
        
        // Winners section
        winnersTitle: 'Danh sÃ¡ch trÃºng thÆ°á»Ÿng',
        winnerNumber: 'MÃ£ sá»‘',
        winnerName: 'TÃªn',
        winnerPrize: 'Giáº£i thÆ°á»Ÿng',
        
        // Participants section
        participantsTitle: 'Quáº£n lÃ½ danh sÃ¡ch tham gia',
        participantsPlaceholder: `Nháº­p danh sÃ¡ch tham gia (má»—i dÃ²ng má»™t ngÆ°á»i):
MÃ£ - TÃªn

VÃ­ dá»¥:
VNPT000001 - Nguyá»…n VÄƒn A
CTV000001 - Tráº§n Thá»‹ B
VNPT000002 - LÃª VÄƒn C
...

Hoáº·c chá»‰ nháº­p mÃ£:
VNPT000001
CTV000001
VNPT000002`,
        totalParticipants: 'Tá»•ng sá»‘ tham gia:',
        remainingParticipants: 'CÃ²n láº¡i:',
        
        // Alerts
        alertNoInput: 'Vui lÃ²ng nháº­p danh sÃ¡ch sá»‘ tham gia!',
        alertInvalidList: 'Danh sÃ¡ch khÃ´ng há»£p lá»‡!',
        alertLoadSuccess: 'ÄÃ£ táº£i {count} sá»‘ tham gia thÃ nh cÃ´ng!',
        alertNoRemaining: 'KhÃ´ng cÃ²n sá»‘ tham gia nÃ o! Vui lÃ²ng táº£i láº¡i danh sÃ¡ch.',
        
        // Congratulations popup
        congratulations: 'CHÃšC Má»ªNG!',
        winnerCode: 'MÃ£ sá»‘:',
        winnerNameLabel: 'TÃªn:',
        prizeLabel: 'Giáº£i thÆ°á»Ÿng:',
        btnClose: 'ÄÃ³ng',
        
        // Footer
        footerText: 'Â© 2026 Lucky Draw. All rights reserved.',
        
        // Default participant name
        defaultParticipant: 'NgÆ°á»i tham gia',
        
        // Prize names (lowercase for data)
        prizeSpecialData: 'giáº£i Ä‘áº·c biá»‡t',
        prizeFirstData: 'giáº£i nháº¥t',
        prizeSecondData: 'giáº£i nhÃ¬',
        prizeThirdData: 'giáº£i ba',
        prizeConsolationData: 'giáº£i khuyáº¿n khÃ­ch',
        
        // Settings section
        settingsTitle: 'Cáº¥u hÃ¬nh há»‡ thá»‘ng',
        timingSettings: 'CÃ i Ä‘áº·t thá»i gian',
        prizeSettings: 'Danh sÃ¡ch giáº£i thÆ°á»Ÿng',
        spinDuration: 'Thá»i gian quay sá»‘ (giÃ¢y):',
        digitDelay: 'Thá»i gian hiá»‡n tá»«ng sá»‘ (giÃ¢y):',
        spinDurationHint: 'Thá»i gian chá» trÆ°á»›c khi hiá»ƒn thá»‹ káº¿t quáº£',
        digitDelayHint: 'Khoáº£ng cÃ¡ch thá»i gian giá»¯a cÃ¡c sá»‘ káº¿t quáº£',
        prizeSpecialLabel: 'Giáº£i Ä‘áº·c biá»‡t:',
        prizeFirstLabel: 'Giáº£i nháº¥t:',
        prizeSecondLabel: 'Giáº£i nhÃ¬:',
        prizeThirdLabel: 'Giáº£i ba:',
        prizeConsolationLabel: 'Giáº£i khuyáº¿n khÃ­ch:',
        prizePlaceholder: 'Nháº­p tÃªn giáº£i thÆ°á»Ÿng',
        btnSaveSettings: 'LÆ°u cáº¥u hÃ¬nh',
        btnResetSettings: 'KhÃ´i phá»¥c máº·c Ä‘á»‹nh',
        alertSettingsSaved: 'ÄÃ£ lÆ°u cáº¥u hÃ¬nh thÃ nh cÃ´ng!',
        alertSettingsReset: 'ÄÃ£ khÃ´i phá»¥c cáº¥u hÃ¬nh máº·c Ä‘á»‹nh!'
    },
    en: {
        // Header
        appTitle: 'LUCKY DRAW',
        
        // Prize levels
        prizeSpecial: 'GRAND PRIZE',
        prizeFirst: 'FIRST PRIZE',
        prizeSecond: 'SECOND PRIZE',
        prizeThird: 'THIRD PRIZE',
        prizeConsolation: 'CONSOLATION PRIZE',
        
        // Display area
        instruction: 'Press Draw button to start',
        
        // Buttons
        btnDraw: 'DRAW',
        btnDrawing: 'DRAWING...',
        btnLoad: 'Load List',
        btnRegister: 'REGISTER',
        
        // Winners section
        winnersTitle: 'Winners List',
        winnerNumber: 'Code',
        winnerName: 'Name',
        winnerPrize: 'Prize',
        
        // Participants section
        participantsTitle: 'Manage Participants',
        participantsPlaceholder: `Enter participant list (one per line):
Code - Name

Example:
VNPT000001 - John Doe
CTV000001 - Jane Smith
VNPT000002 - Mike Johnson
...

Or just codes:
VNPT000001
CTV000001
VNPT000002`,
        totalParticipants: 'Total participants:',
        remainingParticipants: 'Remaining:',
        
        // Alerts
        alertNoInput: 'Please enter the participant list!',
        alertInvalidList: 'Invalid list!',
        alertLoadSuccess: 'Successfully loaded {count} participants!',
        alertNoRemaining: 'No participants remaining! Please reload the list.',
        
        // Congratulations popup
        congratulations: 'CONGRATULATIONS!',
        winnerCode: 'Code:',
        winnerNameLabel: 'Name:',
        prizeLabel: 'Prize:',
        btnClose: 'Close',
        
        // Footer
        footerText: 'Â© 2026 Lucky Draw. All rights reserved.',
        
        // Default participant name
        defaultParticipant: 'Participant',
        
        // Prize names (lowercase for data)
        prizeSpecialData: 'grand prize',
        prizeFirstData: 'first prize',
        prizeSecondData: 'second prize',
        prizeThirdData: 'third prize',
        prizeConsolationData: 'consolation prize',
        
        // Settings section
        settingsTitle: 'System Configuration',
        timingSettings: 'Timing Settings',
        prizeSettings: 'Prize Rewards List',
        spinDuration: 'Spin duration (seconds):',
        digitDelay: 'Digit display delay (seconds):',
        spinDurationHint: 'Wait time before showing result',
        digitDelayHint: 'Time interval between each result digit',
        prizeSpecialLabel: 'Grand Prize:',
        prizeFirstLabel: 'First Prize:',
        prizeSecondLabel: 'Second Prize:',
        prizeThirdLabel: 'Third Prize:',
        prizeConsolationLabel: 'Consolation Prize:',
        prizePlaceholder: 'Enter prize name',
        btnSaveSettings: 'Save Configuration',
        btnResetSettings: 'Reset to Default',
        alertSettingsSaved: 'Configuration saved successfully!',
        alertSettingsReset: 'Configuration reset to default!'
    }
};

// Language Manager
class LanguageManager {
    constructor() {
        this.currentLanguage = localStorage.getItem('luckydraw_language') || 'vi';
        this.translations = translations;
    }
    
    setLanguage(lang) {
        if (!this.translations[lang]) {
            console.error(`Language ${lang} not found`);
            return;
        }
        
        this.currentLanguage = lang;
        localStorage.setItem('luckydraw_language', lang);
        this.updatePageContent();
    }
    
    t(key) {
        return this.translations[this.currentLanguage][key] || key;
    }
    
    updatePageContent() {
        // Update header
        const appTitle = document.querySelector('.logo h1');
        if (appTitle) appTitle.textContent = this.t('appTitle');
        
        // Update prize buttons
        const prizeBtns = document.querySelectorAll('.prize-btn');
        const prizeKeys = ['prizeSpecial', 'prizeFirst', 'prizeSecond', 'prizeThird', 'prizeConsolation'];
        prizeBtns.forEach((btn, index) => {
            const span = btn.querySelector('span:last-child');
            if (span) span.textContent = this.t(prizeKeys[index]);
        });
        
        // Update current prize display
        const currentPrizeDisplay = document.querySelector('.current-prize');
        if (currentPrizeDisplay && window.luckyDraw) {
            const prizeIndex = ['giáº£i Ä‘áº·c biá»‡t', 'giáº£i nháº¥t', 'giáº£i nhÃ¬', 'giáº£i ba', 'giáº£i khuyáº¿n khÃ­ch'].indexOf(window.luckyDraw.currentPrize);
            if (prizeIndex >= 0) {
                currentPrizeDisplay.textContent = this.t(prizeKeys[prizeIndex]);
            }
        }
        
        // Update instruction
        const instruction = document.querySelector('.instruction');
        if (instruction) instruction.textContent = this.t('instruction');
        
        // Update draw button
        const drawBtn = document.querySelector('.btn-draw span');
        if (drawBtn && !window.luckyDraw?.isSpinning) {
            drawBtn.textContent = this.t('btnDraw');
        }
        
        // Update winners section
        const winnersTitle = document.querySelector('.winners-section h3');
        if (winnersTitle) winnersTitle.textContent = this.t('winnersTitle');
        
        // Update participants section
        const participantsTitle = document.querySelector('.participants-section h2');
        if (participantsTitle) participantsTitle.textContent = this.t('participantsTitle');
        
        const participantsInput = document.getElementById('participants-input');
        if (participantsInput) participantsInput.placeholder = this.t('participantsPlaceholder');
        
        const loadBtn = document.getElementById('load-participants');
        if (loadBtn) loadBtn.textContent = this.t('btnLoad');
        
        // Update participants info labels
        const totalLabel = document.querySelector('.participants-info p:first-child');
        if (totalLabel) {
            const count = document.getElementById('total-participants').textContent;
            totalLabel.innerHTML = `${this.t('totalParticipants')} <strong id="total-participants">${count}</strong>`;
        }
        
        const remainingLabel = document.querySelector('.participants-info p:last-child');
        if (remainingLabel) {
            const count = document.getElementById('remaining-participants').textContent;
            remainingLabel.innerHTML = `${this.t('remainingParticipants')} <strong id="remaining-participants">${count}</strong>`;
        }
        
        // Update footer
        const footer = document.querySelector('footer p');
        if (footer) footer.textContent = this.t('footerText');
        
        // Update settings section
        const settingsTitle = document.querySelector('.settings-section h2');
        if (settingsTitle) settingsTitle.textContent = this.t('settingsTitle');
        
        const timingTitle = document.querySelector('.settings-section .settings-group:first-child h3');
        if (timingTitle) timingTitle.textContent = 'â±ï¸ ' + this.t('timingSettings');
        
        const prizeTitle = document.querySelector('.settings-section .settings-group:last-child h3');
        if (prizeTitle) prizeTitle.textContent = 'ðŸŽ ' + this.t('prizeSettings');
        
        // Update settings labels
        const spinDurationLabel = document.querySelector('label[for="spin-duration"]');
        if (spinDurationLabel) spinDurationLabel.textContent = this.t('spinDuration');
        
        const digitDelayLabel = document.querySelector('label[for="digit-delay"]');
        if (digitDelayLabel) digitDelayLabel.textContent = this.t('digitDelay');
        
        const spinDurationHint = document.querySelector('label[for="spin-duration"]').nextElementSibling.nextElementSibling;
        if (spinDurationHint) spinDurationHint.textContent = this.t('spinDurationHint');
        
        const digitDelayHint = document.querySelector('label[for="digit-delay"]').nextElementSibling.nextElementSibling;
        if (digitDelayHint) digitDelayHint.textContent = this.t('digitDelayHint');
        
        // Update prize labels
        const prizeLabels = [
            { selector: 'label[for="prize-special"]', key: 'prizeSpecialLabel' },
            { selector: 'label[for="prize-first"]', key: 'prizeFirstLabel' },
            { selector: 'label[for="prize-second"]', key: 'prizeSecondLabel' },
            { selector: 'label[for="prize-third"]', key: 'prizeThirdLabel' },
            { selector: 'label[for="prize-consolation"]', key: 'prizeConsolationLabel' }
        ];
        
        prizeLabels.forEach(({ selector, key }) => {
            const label = document.querySelector(selector);
            if (label) label.textContent = this.t(key);
        });
        
        // Update prize placeholders
        document.querySelectorAll('.settings-group input[type="text"]').forEach(input => {
            input.placeholder = this.t('prizePlaceholder');
        });
        
        // Update settings buttons
        const saveBtn = document.getElementById('save-settings');
        if (saveBtn) saveBtn.innerHTML = 'ðŸ’¾ ' + this.t('btnSaveSettings');
        
        const resetBtn = document.getElementById('reset-settings');
        if (resetBtn) resetBtn.innerHTML = 'ðŸ”„ ' + this.t('btnResetSettings');
        
        // Update language selector active state
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.lang === this.currentLanguage);
        });
        
        // Re-translate winners list
        if (window.luckyDraw && window.luckyDraw.winners.length > 0) {
            window.luckyDraw.updateWinnersList();
        }
    }
    
    getPrizeTranslation(prizeData) {
        const prizeMap = {
            'giáº£i Ä‘áº·c biá»‡t': 'prizeSpecial',
            'giáº£i nháº¥t': 'prizeFirst',
            'giáº£i nhÃ¬': 'prizeSecond',
            'giáº£i ba': 'prizeThird',
            'giáº£i khuyáº¿n khÃ­ch': 'prizeConsolation',
            'grand prize': 'prizeSpecial',
            'first prize': 'prizeFirst',
            'second prize': 'prizeSecond',
            'third prize': 'prizeThird',
            'consolation prize': 'prizeConsolation'
        };
        
        const key = prizeMap[prizeData.toLowerCase()];
        return key ? this.t(key) : prizeData;
    }
}

// Initialize language manager
const languageManager = new LanguageManager();
